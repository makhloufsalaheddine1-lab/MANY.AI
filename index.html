<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MANY.AI | Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ø´Ø§Ù…Ù„</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; background: #020617; color: #f8fafc; overflow-x: hidden; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); }
        .ai-border { border: 2px solid transparent; background: linear-gradient(#020617, #020617) padding-box, linear-gradient(90deg, #22c55e, #3b82f6) border-box; }
        .scan-line { height: 2px; background: #22c55e; box-shadow: 0 0 20px #22c55e; position: absolute; width: 100%; top: 0; animation: scan 2s linear infinite; }
        @keyframes scan { 0% { top: 0; } 100% { top: 100%; } }
        #video-container { position: relative; border-radius: 1.5rem; overflow: hidden; background: #000; }
        canvas { position: absolute; top: 0; left: 0; z-index: 10; }
        .hidden { display: none; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div id="notif-area" class="fixed top-5 left-5 z-50 space-y-2"></div>

    <div id="login-screen" class="max-w-md mx-auto mt-10 p-8 glass rounded-[2.5rem] shadow-2xl">
        <div class="text-center mb-10">
            <h1 class="text-5xl font-black italic tracking-tighter mb-2">MANY<span class="text-green-500">.AI</span></h1>
            <p class="text-[10px] text-blue-400 font-bold tracking-[0.4em]">Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ Ø§Ù„Ø°ÙƒÙŠ</p>
        </div>
        <div class="space-y-4">
            <input type="text" id="m-shop" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù„ (Ø§Ù„Ø¨Ø±ÙƒØ©ØŒ Ø§Ù„Ù‚Ø¯Ø³...)" class="w-full p-4 bg-white/5 rounded-2xl outline-none focus:ring-2 ring-green-500">
            <input type="tel" id="m-phone" placeholder="Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ Ù„Ù„ØªÙØ¹ÙŠÙ„" class="w-full p-4 bg-white/5 rounded-2xl outline-none">
            <div class="p-4 bg-green-500/5 border border-green-500/20 rounded-2xl">
                <p class="text-[9px] text-green-400 mb-2 text-center">Ø¯ÙØ¹ 1000/2000 Ø¯Ø¬ Ø¹Ø¨Ø± Ø¨Ø±ÙŠØ¯ÙŠ Ù…ÙˆØ¨ (Ø§Ù„ØªØ­Ù‚Ù‚ Ø¢Ù„ÙŠ)</p>
                <input type="text" id="tx-ref" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© (TxID)" class="w-full p-3 bg-black/50 rounded-xl text-center font-mono">
            </div>
            <button onclick="startAI()" class="w-full py-5 bg-green-600 rounded-[2rem] font-black text-xl hover:bg-green-500 transition-all shadow-[0_0_30px_rgba(34,197,94,0.3)]">ØªØ´ØºÙŠÙ„ Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ âš¡</button>
        </div>
    </div>

    <div id="main-app" class="max-w-6xl mx-auto hidden">
        <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
            <div class="flex items-center gap-4">
                <div class="w-16 h-16 ai-border rounded-full flex items-center justify-center font-black text-2xl">M</div>
                <div>
                    <h2 id="disp-shop" class="text-2xl font-black text-white"></h2>
                    <p class="text-xs text-green-400 font-bold">Ø§Ù„Ø­Ø§Ù„Ø©: Ø§Ù„ÙˆÙƒÙŠÙ„ ÙŠØ±Ø§Ù‚Ø¨ Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø¢Ù† âœ…</p>
                </div>
            </div>
            <div class="bg-black/40 px-6 py-3 rounded-full border border-white/10">
                <span id="order-count" class="text-blue-400 font-bold">0</span> <span class="text-[10px] text-gray-400">Ø·Ù„Ø¨ÙŠØ§Øª ØªÙ… Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§ Ø¢Ù„ÙŠØ§Ù‹</span>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2 space-y-6">
                <div class="p-6 glass rounded-[2.5rem] relative group">
                    <h3 class="text-sm font-bold mb-4 flex items-center gap-2">ğŸ‘ï¸ Ø±Ø¤ÙŠØ© Ø§Ù„ÙˆÙƒÙŠÙ„ (Object Recognition)</h3>
                    <div id="video-container">
                        <video id="webcam" autoplay playsinline muted></video>
                        <canvas id="overlay"></canvas>
                        <div id="scanner" class="scan-line"></div>
                    </div>
                    <div class="mt-6 grid grid-cols-2 md:grid-cols-4 gap-3">
                        <input type="text" id="p-name" placeholder="Ø§Ù„Ø³Ù„Ø¹Ø©" class="p-3 bg-white/5 rounded-xl text-xs">
                        <input type="number" id="p-qty" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©" class="p-3 bg-white/5 rounded-xl text-xs">
                        <input type="number" id="p-price" placeholder="Ø§Ù„Ø³Ø¹Ø±" class="p-3 bg-white/5 rounded-xl text-xs">
                        <button onclick="saveProduct()" class="bg-white text-black font-black py-3 rounded-xl text-xs">ØªØ«Ø¨ÙŠØª ğŸ’¾</button>
                    </div>
                </div>

                <div class="p-6 glass rounded-[2.5rem]">
                    <table class="w-full text-right">
                        <thead>
                            <tr class="text-[10px] text-gray-500 border-b border-white/5">
                                <th class="pb-4">Ø§Ù„Ù…Ù†ØªØ¬</th><th class="pb-4 text-center">Ø§Ù„ÙƒÙ…ÙŠØ©</th><th class="pb-4 text-center">Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</th><th class="pb-4 text-left">ØªÙˆØµÙŠØ© AI</th>
                            </tr>
                        </thead>
                        <tbody id="inventory-data"></tbody>
                    </table>
                </div>
            </div>

            <div class="space-y-6">
                <div class="p-6 glass rounded-[2.5rem] bg-blue-500/5">
                    <h3 class="text-sm font-bold mb-4">ğŸ§ Ø­Ù„ Ø£Ø²Ù…Ø© Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª</h3>
                    <p class="text-[10px] text-gray-400 mb-4">Ø§Ù„ÙˆÙƒÙŠÙ„ ÙŠÙ‚ÙˆÙ… Ø§Ù„Ø¢Ù† Ø¨ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ© Ø¥Ù„Ù‰ Ø·Ù„Ø¨ÙŠØ§Øª Ù…Ø¤ÙƒØ¯Ø©.</p>
                    <button onclick="simulateOrder()" class="w-full py-4 bg-blue-600 rounded-2xl font-bold text-xs">Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø·Ù„Ø¨ÙŠØ© ØµÙˆØªÙŠØ©</button>
                </div>

                <div class="p-6 glass rounded-[2.5rem] border-red-500/20">
                    <h3 class="text-sm font-bold mb-4">ğŸ“ˆ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³ÙˆÙ‚ (Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±)</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between text-[10px]"><span class="text-gray-400">Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ "Ø§Ù„Ø¹Ø§ØµÙ…Ø©"</span><span class="text-green-400 font-bold">Ù…Ø±ØªÙØ¹ ğŸ”¥</span></div>
                        <div class="flex justify-between text-[10px]"><span class="text-gray-400">Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ "ÙˆÙ‡Ø±Ø§Ù†"</span><span class="text-blue-400 font-bold">Ù…Ø³ØªÙ‚Ø± âš–ï¸</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let model;
        let video = document.getElementById('webcam');
        let canvas = document.getElementById('overlay');
        let ctx = canvas.getContext('2d');

        async function startAI() {
            const shop = document.getElementById('m-shop').value;
            const ref = document.getElementById('tx-ref').value;

            if(!shop || !ref) { alert("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù„ ÙˆØ±Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹"); return; }

            showNotif("ğŸ§  Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¹Ù‚Ù„ Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ...");
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù…Ù† Google
            model = await cocoSsd.load();
            
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');
            document.getElementById('disp-shop').innerText = "Ù…ØªØ¬Ø± " + shop;

            startWebcam();
            showNotif("âœ… Ø§Ù„ÙˆÙƒÙŠÙ„ ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù† ÙˆÙŠØ±Ø§Ù‚Ø¨ Ø§Ù„Ù…Ø­Ù„");
        }

        async function startWebcam() {
            const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" }, audio: false });
            video.srcObject = stream;
            video.onloadedmetadata = () => {
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                detectFrame();
            };
        }

        async function detectFrame() {
            const predictions = await model.detect(video);
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            predictions.forEach(prediction => {
                ctx.strokeStyle = "#22c55e";
                ctx.lineWidth = 4;
                ctx.strokeRect(...prediction.bbox);
                ctx.fillStyle = "#22c55e";
                ctx.font = "bold 16px Tajawal";
                ctx.fillText(`Ù…ÙƒØªØ´Ù: ${prediction.class}`, prediction.bbox[0], prediction.bbox[1] > 10 ? prediction.bbox[1] - 5 : 10);
            });
            requestAnimationFrame(detectFrame);
        }

        function saveProduct() {
            const name = document.getElementById('p-name').value;
            const qty = document.getElementById('p-qty').value;
            const price = document.getElementById('p-price').value;
            if(!name || !qty) return;

            const row = `
                <tr class="border-b border-white/5 animate-pulse">
                    <td class="py-4 font-black text-white">${name}</td>
                    <td class="text-center">${qty}</td>
                    <td class="text-center font-bold text-green-400">${price} Ø¯Ø¬</td>
                    <td class="text-left text-[9px] font-bold ${qty < 5 ? 'text-red-500' : 'text-blue-400'}">
                        ${qty < 5 ? 'âš ï¸ Ø§Ø·Ù„Ø¨ ÙÙˆØ±Ø§Ù‹' : 'âœ¨ Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø¢Ù…Ù†'}
                    </td>
                </tr>
            `;
            document.getElementById('inventory-data').innerHTML += row;
            showNotif(`ğŸ“¦ ØªÙ… ØªØ³ÙŠÙŠØ± ${name} Ø¨Ù†Ø¬Ø§Ø­`);
        }

        function simulateOrder() {
            showNotif("ğŸ§ Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨ÙŠØ© ØµÙˆØªÙŠØ© ÙˆØ§Ø±Ø¯Ø©...");
            setTimeout(() => {
                let count = parseInt(document.getElementById('order-count').innerText);
                document.getElementById('order-count').innerText = count + 1;
                showNotif("âœ… ØªÙ… ØªØ­ÙˆÙŠÙ„ Ù…ÙƒØ§Ù„Ù…Ø© Ø¥Ù„Ù‰ Ø·Ù„Ø¨ÙŠØ© (Ø­Ø°Ø§Ø¡ Ù…Ù‚Ø§Ø³ 42) - ØªÙ… Ø§Ù„Ø­Ø¬Ø²");
            }, 3000);
        }

        function showNotif(msg) {
            const area = document.getElementById('notif-area');
            const n = document.createElement('div');
            n.className = "p-4 glass border-l-4 border-blue-500 rounded-xl text-xs shadow-2xl animate-bounce";
            n.innerText = msg; area.appendChild(n);
            setTimeout(() => n.remove(), 4000);
        }
    </script>
</body>
</html>
