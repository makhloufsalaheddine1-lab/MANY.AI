<script>
    // نظام حفظ البيانات السحابي (Cloud Sync)
    async function syncDataToCloud(data) {
        console.log("Cloud Sync: جاري تشفير وحفظ البيانات سحابياً...");
        // هنا سيتم الربط مع Google Sheets في الخطوة القادمة
        pushNotification("☁️ تم مزامنة البيانات مع السحابة بنجاح");
    }

    // تمديد وظيفة تفعيل النظام لتشمل الحفظ
    function activateSystem() {
        const name = document.getElementById('m-name').value;
        const phone = document.getElementById('m-phone').value;
        const plan = document.getElementById('plan-select').value;

        if(!name || !phone) {
            alert("يرجى إكمال البيانات");
            return;
        }

        // حفظ البيانات محلياً وسحابياً
        const merchantData = { name, phone, plan, date: new Date().toISOString() };
        localStorage.setItem('merchant_info', JSON.stringify(merchantData));
        syncDataToCloud(merchantData);

        // إظهار لوحة التحكم
        document.getElementById('registration-section').classList.add('hidden');
        document.getElementById('dashboard-section').classList.remove('hidden');
        document.getElementById('display-name').innerText = "التاجر: " + name;
        document.getElementById('display-plan').innerText = plan + " دج/شهر";
    }

    // نظام استشعار المخزون الذكي (AI Inventory Alert)
    function checkInventoryLevels(qty, name) {
        if(qty < 5) {
            pushNotification(`⚠️ تنبيه سيبراني: المنتج [${name}] قارب على النفاذ!`);
            // هنا نرسل إيميل تلقائي لك
        }
    }
</script>
